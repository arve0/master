AUI().add("ntnu-tab-module",function(a){a.namespace("NTNU").NtnuTabs=b;function b(c){b.superclass.constructor.apply(this,arguments)}b.NAME="NtnuTabs";b.ATTRS={listNode:{value:"",setter:function(c){return a.one(c)}},contentNode:{value:"",setter:function(c){return a.one(c)}},orientation:{value:"horizontal"},activeTab:{value:0},persistStateUrl:{value:""},activeTabLabel:{value:"",setter:function(c){this.value=c}},onTabChangeHandler:{value:function(){return}},singleTab:{value:false,setter:function(c){this.value=c},validator:a.Lang.isBoolean}};b.TAB='<a href="javascript:void(0);" role="tab" class="ntnu-tab" data-index="{index}" title=""><span class="yui-tab-content ntnu-tab-label">{tablabel}</span></a>';a.extend(b,a.Widget,{renderUI:function(){var c=this.get("contentBox");c.appendChild(this.get("listNode").addClass("tablist"));var d=(this.get("orientation")==="horizontal");c.one(".tablist").all("li").each(function(f,g){f.addClass("ntnu-tab-container");var e=f.text();f.empty();f.append(a.Node.create(a.substitute(b.TAB,{tablabel:e,index:g})))});c.appendChild(this.get("contentNode"))},bindUI:function(){var c=this.get("contentBox");c.delegate("click",this._showTabContentHandler,".ntnu-tab",this);this.on("activeTabLabelChange",a.bind(this._setSubTitleHandler,this));this.on("ntnu:tab:change",a.bind(this._showTabContent,this));this.on("activeTabLabelChange",function(){})},syncUI:function(){var c=this.get("contentBox");this.set("singleTab",(c.one(".tablist").all("li").size()<2));if(!this.get("singleTab")){this.setActiveTab(this.get("activeTab"))}else{c.one(".tablist").hide();this.setActiveTab(0)}},_setSubTitleHandler:function(){if(this.get("singleTab")){var c=this.get("activeTabLabel");this.get("onTabChangeHandler").call(this,c)}},setActiveTab:function(d){this.set("activeTab",d);var e=this.get("contentBox").one('.ntnu-tab[data-index="'+d+'"]');if(e!=undefined){this.set("activeTabLabel",this.get("contentBox").one('.ntnu-tab[data-index="'+d+'"]').text())}else{d=0;this.set("activeTabLabel","")}var c=this.get("activeTabLabel");this.fire("ntnu:tab:change",{index:d,label:c})},getActiveTab:function(){return this.get("activeTab")},_showTabContentHandler:function(d){var f=d.currentTarget;var c=f.getAttribute("data-index");var e=this.get("activeTabLabel");this.fire("ntnu:tab:change",{index:c,label:e})},_showTabContent:function(f){var d=this.get("contentBox");d.all(".ntnu-tab").removeClass("active-tab");var e=d.one('.ntnu-tab[data-index="'+f.index+'"]');if(e!=undefined){e.addClass("active-tab");a.log("Setting active tab: "+e.guid())}d.all(".bookmarks").each(function(g,h){g.hide();if(h==f.index){g.show()}});var c=d.one(".active-tab");if(c!=undefined){this.set("activeTabLabel",c.one("span").text())}else{this.set("activeTabLabel","")}this.set("activeTab",f.index);this._saveSelectedTab(f.index)},_saveSelectedTab:function(e){var c=this.get("persistStateUrl");if(e&&c.length>0){var d={method:"POST",autoLoad:true,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"},data:{bookmarkTabID:parseInt(e)+1},cache:false,on:{success:function(g,h,f){},failure:function(g,h,f){}}};a.io.request(c,d)}},subst:function(c,d){return a.substitute(c,d,a.bind(this.substCss,this))},substCss:function(f,g,c){if(f=="css"){var e="";for(var d=0;d<g.length;d++){e+=a.ClassNameManager.getClassName(b.NAME,g[d])+" "}return e}return g},css:function(c){return a.ClassNameManager.getClassName(b.NAME,c)}})},"3.1.1",{requires:["aui-node","aui-io"]});